[2025-03-25 13:22:36] ‚ùå Unknown action: None
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] ‚ùå Unknown action: delete_file
[2025-03-25 13:45:41] üìÑ File renamed to 'config_template.py'
[2025-03-25 13:46:08] ‚ùå Unknown action: None
[2025-03-25 13:46:09] ‚ùå Unknown action: None
[2025-03-25 13:48:06] ‚úÖ Created file 'test.txt'
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:00] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Unknown action: delete_file
[2025-03-25 13:49:11] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 13:50:01] üìÅ Folder 'BEN_TEST_FOLDER' created
[2025-03-25 13:57:01] ‚ùå Unknown action: delete_file
[2025-03-25 13:57:07] ‚ùå Unknown action: delete_file
[2025-03-25 13:57:09] ‚ùå Unknown action: delete_file
[2025-03-25 13:57:38] ‚ùå Unknown action: delete_file
[2025-03-25 13:57:39] ‚ùå Unknown action: delete_file
[2025-03-25 13:57:43] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:48] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:51] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:52] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Unknown action: delete_file
[2025-03-25 14:03:54] ‚ùå Exception: [WinError 2] The system cannot find the file specified: 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config.py' -> 'C:\\\\Users\\\\DC\\\\OneDrive\\\\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\\\\–ë–û–¢\\config_template.py'
[2025-03-25 14:16:50] ‚úÖ Created file 'ben_delete_test.txt'
[2025-03-25 14:16:50] üóëÔ∏è File 'ben_delete_test.txt' deleted
[2025-03-25 14:16:53] ‚úÖ Created file 'ben_delete_test.txt'
[2025-03-25 14:16:53] üóëÔ∏è File 'ben_delete_test.txt' deleted
[2025-03-25 14:21:47] üìÅ Folder 'BEN.v1' creat
[2025-03-26 15:15:11] ‚úÖ Created file 'BEN_TEST_OK.txt'
[2025-03-26 16:41:25] ‚ùå Unknown action: None
[2025-03-26 16:44:03] ‚ùå Unknown action: None
[2025-03-26 16:55:11] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 17:00:27] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 17:05:17] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 17:09:09] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 17:12:34] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 18:20:29] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:23:29] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:26:43] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:29:05] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:34:41] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:36:34] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:38:47] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:41:41] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:43:44] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 18:58:57] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 19:01:06] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 19:21:31] {'status': 'success', 'steps': [{'status': 'success', 'message': "üìÅ Folder 'ben_gui_desktop' created"}, {'status': 'success', 'message': "‚úÖ Created file 'ben_gui_desktop/ben_gui.py'"}]}
[2025-03-26 19:28:05] ‚úèÔ∏è Replaced text in 'ben_gui_desktop/ben_gui.py'
[2025-03-26 19:29:41] ‚úèÔ∏è Replaced text in 'ben_gui_desktop/ben_gui.py'
[2025-03-26 19:32:39] ‚úèÔ∏è Replaced text in 'ben_gui_desktop/ben_gui.py'
[2025-03-26 19:33:44] ‚úèÔ∏è Replaced text in 'ben_gui_desktop/ben_gui.py'
[2025-03-26 19:34:44] ‚úèÔ∏è Replaced text in 'ben_gui_desktop/ben_gui.py'
[2025-03-26 20:13:36] ‚ùå Unknown action: test_python
[2025-03-26 20:18:16] ‚ùå Unknown action: test_python
[2025-03-26 20:21:32] ‚ùå Unknown action: test_python
[2025-03-26 20:22:56] ‚úÖ run_bot_logic.py –ø—Ä–æ–π—à–æ–≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É
[2025-03-26 20:29:38] ‚ùå –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏–π —Ñ–∞–π–ª: gpt_agent_cache.py
[2025-03-26 20:35:18] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 20:41:03] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-26 20:49:01] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 20:53:09] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 20:57:22] ‚úÖ run_bot_logic.py –ø—Ä–æ–π—à–æ–≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É
[2025-03-26 21:00:28] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-26 21:01:39] ‚ùå Syntax error in gpt_agent_cache.py: unterminated string literal (detected at line 107) (gpt_agent_cache.py, line 107)
[2025-03-26 21:08:44] ‚ùå Syntax error in gpt_agent_cache.py: unterminated string literal (detected at line 107) (gpt_agent_cache.py, line 107)
[2025-03-26 21:11:10] ‚ùå Syntax error in gpt_agent_cache.py: invalid syntax (gpt_agent_cache.py, line 232)
[2025-03-26 21:30:14] {'status': 'success', 'steps': [{'status': 'success', 'message': "üîÅ Updated file 'gpt_agent_cache.py'"}, {'status': 'success', 'message': "üîÅ Updated file 'gpt_agent_cache.py'"}]}
[2025-03-26 21:31:06] ‚ùå Unknown action: undo_change
[2025-03-26 21:49:06] ‚ùå –ù–µ–º–∞—î —Ä–µ–∑–µ—Ä–≤–Ω–æ—ó –∫–æ–ø—ñ—ó –¥–ª—è 'run_bot_logic.py'
[2025-03-26 21:50:52] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 21:50:52] ‚Ü©Ô∏è Undo: –≤—ñ–¥–∫–∞—Ç –¥–æ .bak –¥–ª—è 'run_bot_logic.py'
[2025-03-26 21:57:35] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..bd80ea6 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -88,6 +88,9 @@ def handle_command(cmd):
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,8 +104,7 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
@@ -164,6 +166,13 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -213,7 +222,7 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
-
+        time.sleep(1)
 
 def log_diff(filepath):
     import subprocess
@@ -226,4 +235,5 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+        

[2025-03-26 21:57:35] ‚úèÔ∏è Replaced text in 'gpt_agent_cache.py'
[2025-03-26 21:57:35] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-26 21:58:42] ‚úèÔ∏è Replaced text in 'run_bot_logic.py'
[2025-03-26 22:06:48] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-26 22:06:48] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in gpt_agent_cache.py: invalid syntax (gpt_agent_cache.py, line 111)
[2025-03-26 22:54:23] ‚ùå Unknown action: show_memory
[2025-03-26 23:00:47] ‚ùå Unknown action: show_memory
[2025-03-26 23:03:07] ‚ùå Memory file not found
[2025-03-26 23:04:26] ‚úÖ Created file 'test_memory.txt'
[2025-03-26 23:04:37] {'status': 'success', 'memory': [{'action': 'create_file', 'filename': 'test_memory.txt', 'content': 'Memory test', 'timestamp': '2025-03-26 23:04:26'}]}
[2025-03-26 23:21:10] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-26 23:21:10] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..39d131b 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -17,6 +17,21 @@ def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
+        
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
 
 def read_requests():
     if not os.path.exists(request_file):
@@ -58,11 +73,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +100,15 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +122,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +155,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -141,6 +167,7 @@ def handle_command(cmd):
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +191,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,9 +212,19 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
@@ -213,7 +258,7 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
-
+        time.sleep(1)
 
 def log_diff(filepath):
     import subprocess
@@ -226,4 +271,31 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+        
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-26 23:21:10] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-26 23:34:53] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..6aadb3f 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -17,6 +17,33 @@ def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
+        
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
 
 def read_requests():
     if not os.path.exists(request_file):
@@ -58,11 +85,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +112,15 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +134,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +167,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -141,6 +179,7 @@ def handle_command(cmd):
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +203,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,9 +224,19 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
@@ -213,7 +270,7 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
-
+        time.sleep(1)
 
 def log_diff(filepath):
     import subprocess
@@ -226,4 +283,31 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+        
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-26 23:34:53] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-26 23:34:53] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..6aadb3f 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -17,6 +17,33 @@ def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
+        
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
 
 def read_requests():
     if not os.path.exists(request_file):
@@ -58,11 +85,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +112,15 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +134,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +167,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -141,6 +179,7 @@ def handle_command(cmd):
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +203,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,9 +224,19 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
@@ -213,7 +270,7 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
-
+        time.sleep(1)
 
 def log_diff(filepath):
     import subprocess
@@ -226,4 +283,31 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+        
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-26 23:34:53] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-26 23:43:04] ‚ùå Exception: [Errno 2] No such file or directory: 'C:\\\\Users\\\\DC\\\\my-bot-project\\backup\\test_memory.txt'
[2025-03-26 23:43:46] üìÑ File renamed to 'test_memory_renamed.txt'
[2025-03-26 23:45:15] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..9dc4391 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -18,6 +18,33 @@ def log_action(message):
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -58,11 +85,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +112,15 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +134,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +167,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +175,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +204,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,9 +225,19 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
@@ -213,7 +271,7 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
-
+        time.sleep(1)
 
 def log_diff(filepath):
     import subprocess
@@ -226,4 +284,31 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+        
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-26 23:45:15] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-26 23:50:32] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in test_memory_renamed.txt: invalid syntax (test_memory_renamed.txt, line 1)
[2025-03-27 07:19:48] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..2c4552a 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -18,6 +18,34 @@ def log_action(message):
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+def log_diff(filepath):
+    import subprocess
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -58,11 +86,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +113,15 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +135,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +168,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +176,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +205,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,9 +226,19 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
@@ -213,17 +272,32 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
 
+       
 
-def log_diff(filepath):
-    import subprocess
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
     try:
-        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
-        diff = result.stdout.strip()
-        if diff:
-            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
-            with open(history_file, "a", encoding="utf-8") as f:
-                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        return handle_command(last_cmd)
     except Exception as e:
-        with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-27 07:19:48] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 07:52:48] ‚ùå Unknown action: None
[2025-03-27 07:53:39] ‚ùå Unknown action: None
[2025-03-27 08:15:20] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..266fff4 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,44 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+def log_diff(filepath):
+    import subprocess
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +66,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +88,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +115,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +138,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +171,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +179,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +208,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +229,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -213,17 +276,33 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
 
 
-def log_diff(filepath):
-    import subprocess
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
     try:
-        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
-        diff = result.stdout.strip()
-        if diff:
-            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
-            with open(history_file, "a", encoding="utf-8") as f:
-                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
     except Exception as e:
-        with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-27 08:15:20] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:20:59] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..e586469 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,43 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +65,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +87,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +114,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +137,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +170,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +178,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +207,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +228,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +257,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,17 +277,33 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
 
 
-def log_diff(filepath):
-    import subprocess
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
     try:
-        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
-        diff = result.stdout.strip()
-        if diff:
-            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
-            with open(history_file, "a", encoding="utf-8") as f:
-                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
     except Exception as e:
-        with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-27 08:20:59] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:28:27] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..02913ab 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,43 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +65,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +87,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +114,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +137,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +170,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +178,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +207,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +228,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +257,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,17 +277,40 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
 
 
-def log_diff(filepath):
-    import subprocess
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
     try:
-        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
-        diff = result.stdout.strip()
-        if diff:
-            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
-            with open(history_file, "a", encoding="utf-8") as f:
-                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
     except Exception as e:
-        with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}

[2025-03-27 08:28:27] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:28:47] ‚ùå Unknown action: None
[2025-03-27 08:29:43] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-27 08:41:19] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..d3ebbf4 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +161,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +169,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +198,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +219,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +248,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +268,46 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +317,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:41:19] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:46:17] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..d3ebbf4 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,6 +161,7 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
@@ -137,10 +169,12 @@ def handle_command(cmd):
         elif action == "rename_file":
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +198,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +219,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +248,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +268,46 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +317,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:46:17] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:46:17] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..bdbdc6f 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,17 +161,22 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
 
         elif action == "rename_file":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -164,6 +200,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +221,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +250,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +270,46 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +319,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:46:17] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:46:18] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..a170ea9 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,17 +161,22 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
 
         elif action == "rename_file":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -150,6 +186,8 @@ def handle_command(cmd):
             return {"status": "error", "message": "Folder not found"}
 
         elif action == "run_python":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             result = subprocess.run(["python", full_file_path], capture_output=True, text=True)
             return {"status": "success", "output": result.stdout, "errors": result.stderr}
         
@@ -164,6 +202,14 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
             results = []
             for step in cmd.get("steps", []):
@@ -177,10 +223,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +252,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +272,46 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +321,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:46:18] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:48:59] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-27 08:50:30] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..2b946a4 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,17 +161,22 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
 
         elif action == "rename_file":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -150,6 +186,8 @@ def handle_command(cmd):
             return {"status": "error", "message": "Folder not found"}
 
         elif action == "run_python":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             result = subprocess.run(["python", full_file_path], capture_output=True, text=True)
             return {"status": "success", "output": result.stdout, "errors": result.stderr}
         
@@ -164,7 +202,17 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
+            if not isinstance(cmd.get("steps"), list):
+                return {"status": "error", "message": "–≤—ú–ä Invalid macro steps"}
             results = []
             for step in cmd.get("steps", []):
                 result = handle_command(step)
@@ -177,10 +225,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +254,8 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +274,59 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
+
+
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +336,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:50:30] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:51:56] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..ac0a011 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,17 +161,22 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
 
         elif action == "rename_file":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -150,6 +186,8 @@ def handle_command(cmd):
             return {"status": "error", "message": "Folder not found"}
 
         elif action == "run_python":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             result = subprocess.run(["python", full_file_path], capture_output=True, text=True)
             return {"status": "success", "output": result.stdout, "errors": result.stderr}
         
@@ -164,7 +202,17 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
+            if not isinstance(cmd.get("steps"), list):
+                return {"status": "error", "message": "–≤—ú–ä Invalid macro steps"}
             results = []
             for step in cmd.get("steps", []):
                 result = handle_command(step)
@@ -177,10 +225,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +254,10 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                push_result = git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
+                print(push_result.get('message', ''))
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +276,59 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
+
+
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +338,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:51:56] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 08:53:28] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index 02d0a3a..2320660 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -6,18 +6,34 @@ import time
 import re
 import shutil
 import subprocess
+import traceback
 from datetime import datetime, timezone
 
-base_path = r"C:\\Users\\DC\\my-bot-project"
-request_file = os.path.join(base_path, "cache.txt")
-response_file = os.path.join(base_path, "gpt_response.json")
-history_file = os.path.join(base_path, "ben_history.log")
+from config import base_path, request_file, response_file, history_file
 
 def log_action(message):
     timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
     with open(history_file, "a", encoding="utf-8") as f:
         f.write(f"[{timestamp}] {message}\n")
 
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
+
+def save_to_memory(cmd):
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    try:
+        if os.path.exists(memory_file):
+            with open(memory_file, "r", encoding="utf-8") as f:
+                memory = json.load(f)
+        else:
+            memory = []
+        cmd["timestamp"] = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+        memory.append(cmd)
+        with open(memory_file, "w", encoding="utf-8") as f:
+            json.dump(memory[-100:], f, indent=2, ensure_ascii=False)
+    except Exception as e:
+        log_action(f"–≤—ô¬†–ø—ë–è Error saving to memory: {str(e)}")
+
 def read_requests():
     if not os.path.exists(request_file):
         return []
@@ -40,6 +56,10 @@ def clear_cache():
         f.write("")
 
 def handle_command(cmd):
+    required_keys = ["action"]
+    for key in required_keys:
+        if key not in cmd:
+            return {"status": "error", "message": f"–≤—ú–ä Missing required field: {key}"}
     try:
         action = cmd.get("action")
         filename = cmd.get("filename")
@@ -58,11 +78,13 @@ def handle_command(cmd):
         if action == "create_file":
             with open(full_file_path, "w", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)  
             return {"status": "success", "message": f"–≤—ö‚Ä¶ Created file '{filename}'"}
 
         elif action == "append_file":
             with open(full_file_path, "a", encoding="utf-8") as f:
                 f.write(content)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú–ä Appended to file '{filename}'"}
         elif action == "scan_all_files":
             result = {}
@@ -83,11 +105,16 @@ def handle_command(cmd):
                 updated = re.sub(pattern, replacement, data)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(updated)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äù–É Updated file '{filename}'"}
             else:
                 return {"status": "error", "message": "File not found"}
 
         elif action == "replace_in_file":
+            if filename.endswith('.py'):
+                test_result = handle_command({"action": "test_python", "filename": filename})
+            if test_result.get("status") == "error":
+                return {"status": "error", "message": f"–≤—ú–ä –†—ü–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã: {test_result.get('message')}"}
             if filename in ["config.py", "api_keys.py", "cache.txt"]:
                 return {"status": "error", "message": f"–≤—ú–ä –†‚Äî–†¬∞–†¬±–†—ï–°–Ç–†—ï–†–Ö–†¬µ–†–Ö–†—ï –†¬∑–†—ò–°‚Äì–†–Ö–°–ã–†–Ü–†¬∞–°‚Äö–†—ë –†—î–°–Ç–†—ë–°‚Äö–†—ë–°‚Ä°–†–Ö–†—ë–†‚Ññ –°‚Äû–†¬∞–†‚Ññ–†¬ª: {filename}"}
             if os.path.exists(full_file_path):
@@ -101,19 +128,23 @@ def handle_command(cmd):
                 try:
                     diff_output = subprocess.check_output(["git", "diff", full_file_path], cwd=base_path, text=True)
                     if diff_output.strip():
-                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:
-" + diff_output)
+                        log_action("—Ä—ü‚Äú‚Äû Git diff –†—ó–†¬µ–°–Ç–†¬µ–†“ë –†¬∑–†—ò–°‚Äì–†–Ö–†—ï–°–ã:" + diff_output)
                 except Exception as e:
                     log_action(f"–≤—ô¬†–ø—ë–è Git diff error: {str(e)}")
                 # —Ä—ü‚Äù–É –†‚Äî–†¬∞–†—ò–°‚Äì–†–Ö–†¬∞ –°‚Ä°–†¬µ–°–Ç–†¬µ–†¬∑ regex
                 new_text = re.sub(pattern, replacement, text)
                 with open(full_file_path, "w", encoding="utf-8") as f:
                     f.write(new_text)
+                    
+                # —Ä—ü‚Äú—ö –†‚Ä∫–†—ï–†—ñ –†¬∑–†—ò–°‚Äì–†–Ö (git diff)
+                log_diff(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"–≤—ö–è–ø—ë–è Replaced text in '{filename}'"}
         elif action == "read_file":
             if os.path.exists(full_file_path):
                 with open(full_file_path, "r", encoding="utf-8") as f:
                     return {"status": "success", "content": f.read()}
+            save_to_memory(cmd)
             return {"status": "error", "message": "File not found"}
 
         elif action == "search_text_in_file":
@@ -130,17 +161,22 @@ def handle_command(cmd):
         elif action == "delete_file":
             if os.path.exists(full_file_path):
                 os.remove(full_file_path)
+                save_to_memory(cmd)
                 return {"status": "success", "message": f"—Ä—ü‚Äî‚Äò–ø—ë–è File '{filename}' deleted"}
             else:
                 return {"status": "error", "message": f"File '{filename}' not found"}
 
         elif action == "rename_file":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             new_path = os.path.join(base_path, new_name)
             os.rename(full_file_path, new_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äû File renamed to '{new_name}'"}
 
         elif action == "copy_file":
             shutil.copy(full_file_path, dst_file_path)
+            save_to_memory(cmd)
             return {"status": "success", "message": f"—Ä—ü‚Äú‚Äö Copied '{filename}' to '{target_folder}'"}
 
         elif action == "read_folder":
@@ -150,6 +186,8 @@ def handle_command(cmd):
             return {"status": "error", "message": "Folder not found"}
 
         elif action == "run_python":
+            if not os.path.exists(full_file_path):
+                return {"status": "error", "message": f"–≤—ú–ä File '{filename}' not found"}
             result = subprocess.run(["python", full_file_path], capture_output=True, text=True)
             return {"status": "success", "output": result.stdout, "errors": result.stderr}
         
@@ -164,7 +202,17 @@ def handle_command(cmd):
                     return {"status": "error", "message": f"–≤—ú–ä Syntax error in {filename}: {e}"}
             return {"status": "error", "message": "File not found"}
 
+        elif action == "undo_change":
+            if os.path.exists(full_file_path + ".bak"):
+                shutil.copy(full_file_path + ".bak", full_file_path)
+                save_to_memory(cmd)
+                return {"status": "success", "message": f"–≤‚Ä†¬©–ø—ë–è Undo: –†–Ü–°‚Äì–†“ë–†—î–†¬∞–°‚Äö –†“ë–†—ï .bak –†“ë–†¬ª–°–è '{filename}'"}
+            else:
+                return {"status": "error", "message": f"–≤—ú–ä –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –°–Ç–†¬µ–†¬∑–†¬µ–°–Ç–†–Ü–†–Ö–†—ï–°‚Äî –†—î–†—ï–†—ó–°‚Äì–°‚Äî –†“ë–†¬ª–°–è '{filename}'"}
+
         elif action == "macro":
+            if not isinstance(cmd.get("steps"), list):
+                return {"status": "error", "message": "–≤—ú–ä Invalid macro steps"}
             results = []
             for step in cmd.get("steps", []):
                 result = handle_command(step)
@@ -177,10 +225,21 @@ def handle_command(cmd):
         elif action == "check_status":
             return {"status": "success", "message": "—Ä—ü—ü—û Agent is running"}
 
+        elif action == "show_memory":
+            memory_file = os.path.join(base_path, ".ben_memory.json")
+            if os.path.exists(memory_file):
+                with open(memory_file, "r", encoding="utf-8") as f:
+                    memory = json.load(f)
+                return {"status": "success", "memory": memory[-20:]}
+            else:
+                return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+
         else:
             return {"status": "error", "message": f"–≤—ú–ä Unknown action: {action}"}
 
+
     except Exception as e:
+        traceback.print_exc()
         return {"status": "error", "message": f"–≤—ú–ä Exception: {str(e)}"}
 
 if __name__ == "__main__":
@@ -195,6 +254,10 @@ if __name__ == "__main__":
             print("–≤—ö‚Ä¶ –†‚Äô–†—ë–†—î–†—ï–†–Ö–†¬∞–†–Ö–†—ï:", result)  # –†—ü–†—ï–†—î–†¬∞–†¬∑–°—ì–°‚Äù –°–Ç–†¬µ–†¬∑–°—ì–†¬ª–°–ä–°‚Äö–†¬∞–°‚Äö –†—î–†—ï–†¬∂–†–Ö–†—ï–°‚Äî –†“ë–°‚Äì–°‚Äî
             responses.append(result)
             log_action(result.get("message", str(result)))
+            if result.get("status") == "success":
+                push_result = git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
+                print(push_result.get('message', ''))
+                git_auto_push(f"–≤—ö‚Ä¶ Auto-commit: {cmd.get('action')} {cmd.get('filename', '')}")
 
         if responses:
             for r in responses:
@@ -213,10 +276,60 @@ if __name__ == "__main__":
             print("—Ä—ü‚Äô—ï –†‚Äî–†¬∞–†—ó–†—ë–°–É–°—ì–°–ã gpt_response.json –°‚Äì –†—ï–°‚Ä°–†—ë–°‚Ä∞–†¬∞–°–ã cache.txt")
             write_response(responses)
             clear_cache()
+        time.sleep(1)
+
+
+
+def git_auto_push(commit_msg="—Ä—ü—ô–Ç Auto-commit by Ben"):
+    try:
+        subprocess.run(["git", "add", "."], cwd=base_path, check=True)
+
+        # —Ä—ü‚Äù–å –†—ü–†¬µ–°–Ç–†¬µ–†–Ü–°‚Äì–°–Ç–†—î–†¬∞ –°‚Ä°–†—ë –°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö–†—ë
+        diff_result = subprocess.run(["git", "diff", "--cached", "--quiet"], cwd=base_path)
+        if diff_result.returncode == 0:
+            log_action("–≤‚Äû‚Ññ–ø—ë–è –†—ú–†¬µ–†—ò–†¬∞–°‚Äù –†¬∑–†—ò–°‚Äì–†–Ö –†“ë–†¬ª–°–è –†—î–†—ï–†—ò–°‚Äì–°‚Äö–°—ì –≤–Ç‚Äù git push –†—ó–°–Ç–†—ï–†—ó–°—ì–°‚Ä∞–†¬µ–†–Ö–†—ï")
+            return {"status": "skipped", "message": "–≤‚Äû‚Ññ–ø—ë–è No changes to commit"}
+
+        subprocess.run(["git", "commit", "-m", commit_msg], cwd=base_path, check=True)
+        subprocess.run(["git", "push"], cwd=base_path, check=True)
+        log_action(f"—Ä—ü‚Äú¬§ Git push: {commit_msg}")
+        save_to_memory({"action": "git_push", "message": commit_msg})
+        return {"status": "success", "message": "—Ä—ü‚Äú¬§ Git push –°—ì–°–É–†—ó–°‚Äì–°‚Ç¨–†–Ö–†—ï –†¬∑–†¬∞–†–Ü–†¬µ–°–Ç–°‚Ç¨–†¬µ–†–Ö–†—ï"}
+
+    except subprocess.CalledProcessError as e:
+        log_action(f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}")
+        return {"status": "error", "message": f"–≤—ú–ä Git push –†—ó–†—ï–†—ò–†—ë–†¬ª–†—î–†¬∞: {str(e)}"}
+
+def repeat_last_action():
+    memory_file = os.path.join(base_path, ".ben_memory.json")
+    if not os.path.exists(memory_file):
+        return {"status": "error", "message": "–≤—ú–ä Memory file not found"}
+    try:
+        with open(memory_file, "r", encoding="utf-8") as f:
+            memory = json.load(f)
+        if not memory:
+            return {"status": "error", "message": "–≤—ú–ä No memory to repeat"}
+        last_cmd = memory[-1]
+        save_to_memory(last_cmd)
+        return handle_command(last_cmd)
+    except Exception as e:
+        return {"status": "error", "message": f"–≤—ú–ä Repeat error: {str(e)}"}
+
+
+def log_diff(filepath):
+    try:
+        result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
+        diff = result.stdout.strip()
+        if diff:
+            timestamp = datetime.now(timezone.utc).strftime("%Y-%m-%d %H:%M:%S")
+            with open(history_file, "a", encoding="utf-8") as f:
+                f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
+    except Exception as e:
+        with open(history_file, "a", encoding="utf-8") as f:
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
 
 
 def log_diff(filepath):
-    import subprocess
     try:
         result = subprocess.run(["git", "diff", filepath], capture_output=True, text=True)
         diff = result.stdout.strip()
@@ -226,4 +339,4 @@ def log_diff(filepath):
                 f.write(f"[DIFF {timestamp}] File: {filepath}\n{diff}\n---\n")
     except Exception as e:
         with open(history_file, "a", encoding="utf-8") as f:
-            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")
\ No newline at end of file
+            f.write(f"[DIFF ERROR] {filepath}: {str(e)}\n")

[2025-03-27 08:53:28] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 10:06:48] üü¢ Agent is running
[2025-03-27 10:07:13] üü¢ Agent is running
[2025-03-27 10:10:59] üü¢ Agent is running
[2025-03-27 10:11:03] üì§ Git push: ‚úÖ Auto-commit: check_status 
[2025-03-27 10:46:08] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 10:46:08] üìÑ Git diff –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é:diff --git a/gpt_agent_cache.py b/gpt_agent_cache.py
index b23dde4..bb35d1f 100644
--- a/gpt_agent_cache.py
+++ b/gpt_agent_cache.py
@@ -325,6 +325,7 @@ def run_cli():
     parser.add_argument("--foldername", help="–†‚Ä†–†—ò'–°–è –†—ó–†¬∞–†—ó–†—î–†—ë")
     parser.add_argument("--target_folder", help="–†¬¶–°‚Äì–†¬ª–°–ä–†—ï–†–Ü–†¬∞ –†—ó–†¬∞–†—ó–†—î–†¬∞")
     parser.add_argument("--new_name", help="–†—ú–†—ï–†–Ü–†¬µ –°‚Äì–†—ò'–°–è –°‚Äû–†¬∞–†‚Ññ–†¬ª–°—ì")
+    parser.add_argument("--steps", help="JSON-–°–Ç–°–è–†“ë–†—ï–†—î –†“ë–†¬ª–°–è macro-–†—î–†—ï–†—ò–†¬∞–†–Ö–†“ë–†—ë")
 
     args = parser.parse_args()
     cmd = {k: v for k, v in vars(args).items() if v is not None}

[2025-03-27 10:46:08] ‚ùå Exception: name 'log_diff' is not defined
[2025-03-27 10:50:38] ‚ö†Ô∏è Function 'log_diff' already exists in gpt_agent_cache.py
[2025-03-27 10:56:06] ‚úÖ Created file 'ben_gui_desktop/ben_gui.py'
[2025-03-27 10:56:14] üì§ Git push: ‚úÖ Auto-commit: create_file ben_gui_desktop/ben_gui.py
[2025-03-27 10:59:00] üìå Appended to file 'ben_gui_desktop/ben_gui.py'
[2025-03-27 10:59:07] üì§ Git push: ‚úÖ Auto-commit: append_file ben_gui_desktop/ben_gui.py
[2025-03-27 11:25:12] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:25:49] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:27:34] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:28:11] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:28:31] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:29:56] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:31:04] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:39:28] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-27 11:39:37] üì§ Git push: ‚úÖ Auto-commit: append_file gpt_agent_cache.py
[2025-03-27 11:42:27] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:46:23] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-27 11:46:30] üì§ Git push: ‚úÖ Auto-commit: append_file gpt_agent_cache.py
[2025-03-27 11:47:38] ‚ùå –ü–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é: ‚ùå Syntax error in ben_gui_desktop/ben_gui.py: unexpected indent (ben_gui_desktop/ben_gui.py, line 70)
[2025-03-27 11:56:40] ‚ùå Unknown action: fix_indentation
[2025-03-27 12:39:35] üìå Appended to file 'gpt_agent_cache.py'
[2025-03-27 12:39:44] üì§ Git push: ‚úÖ Auto-commit: append_file gpt_agent_cache.py
[2025-03-27 12:41:52] ‚ùå Unknown action: list_history
[2025-03-27 12:45:44] ‚ö†Ô∏è Function 'handle_command' already exists in gpt_agent_cache.py
[2025-03-27 15:29:45] ‚ùå Unknown action: update_code
[2025-03-28 09:59:35] ‚ùå Unknown action: update_code
[2025-03-28 10:00:18] ‚ùå Unknown action: edit_file
[2025-03-28 10:00:48] ‚ùå Unknown action: update_code
[2025-03-28 10:01:19] ‚ùå Unknown action: update_code
[2025-03-28 10:02:31] ‚ùå Unknown action: insert_code
[2025-03-28 10:03:19] ‚ùå Unknown action: update_code
[2025-03-28 10:04:10] ‚ùå Unknown action: update_code
[2025-03-28 10:04:52] ‚ùå Unknown action: update_code
[2025-03-28 10:05:06] ‚ùå Unknown action: update_code
[2025-03-28 10:13:40] ‚ùå Unknown action: update_code
[2025-03-28 10:16:11] ‚ùå Unknown action: prepare_update_code_support
[2025-03-28 10:17:08] ‚ùå Unknown action: insert_after_pattern
[2025-03-28 10:17:17] ‚ùå Unknown action: insert_after_pattern
[2025-03-28 10:23:38] ‚ùå Unknown action: update_code
[2025-03-28 10:26:12] ‚ùå Exception: name 'handle_update_code' is not defined
[2025-03-28 10:54:09] ‚ùå Exception: [Errno 2] No such file or directory: 'test_ben_module.py'
[2025-03-28 10:54:40] ‚úÖ Created file 'test_ben_module.py'
[2025-03-28 10:54:43] üì§ Git push: ‚úÖ Auto-commit: create_file test_ben_module.py
[2025-03-28 11:11:17] ‚úÖ update_code applied to test_ben_module.py with type validation
[2025-03-28 11:11:21] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 11:12:12] ‚úÖ update_code applied to test_ben_module.py with type exceptions
[2025-03-28 11:12:15] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 11:22:13] ‚ùå Exception: expected str, bytes or os.PathLike object, not NoneType
[2025-03-28 11:24:29] ‚ùå Exception: expected str, bytes or os.PathLike object, not NoneType
[2025-03-28 11:26:20] ‚ùå Exception: expected str, bytes or os.PathLike object, not NoneType
[2025-03-28 11:35:52] ‚úÖ update_code applied to test_ben_module.py with type validation
[2025-03-28 11:35:55] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 11:37:00] ‚ùå –í –∫–æ–º–∞–Ω–¥—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π file_path –∞–±–æ update_type
[2025-03-28 11:38:11] ‚ùå –í –∫–æ–º–∞–Ω–¥—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π file_path –∞–±–æ update_type
[2025-03-28 11:38:29] ‚ùå –í –∫–æ–º–∞–Ω–¥—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π file_path –∞–±–æ update_type
[2025-03-28 11:45:52] ‚ùå Exception: [Errno 2] No such file or directory: 'test1.py'
[2025-03-28 11:46:58] ‚úÖ Created file 'test1.py'
[2025-03-28 11:47:02] üì§ Git push: ‚úÖ Auto-commit: create_file test1.py
[2025-03-28 11:47:41] ‚úÖ Created file 'test2.py'
[2025-03-28 11:47:44] üì§ Git push: ‚úÖ Auto-commit: create_file test2.py
[2025-03-28 11:47:51] ‚úÖ Created file 'test3.py'
[2025-03-28 11:47:54] üì§ Git push: ‚úÖ Auto-commit: create_file test3.py
[2025-03-28 11:48:14] {'status': 'success', 'results': [{'status': 'success', 'message': '‚úÖ update_code applied to test1.py with type validation'}, {'status': 'success', 'message': '‚úÖ update_code applied to test2.py with type exceptions'}, {'status': 'success', 'message': '‚úÖ update_code applied to test3.py with type logging'}]}
[2025-03-28 11:48:17] üì§ Git push: ‚úÖ Auto-commit: update_code_bulk 
[2025-03-28 11:51:48] ‚ùå –í –∫–æ–º–∞–Ω–¥—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π file_path –∞–±–æ update_type
[2025-03-28 11:54:20] ‚ùå Syntax check failed: ‚ùå Exception: _path_exists: path should be string, bytes, os.PathLike or integer, not NoneType
[2025-03-28 11:55:41] ‚úÖ update_code applied to gpt_agent_cache.py with type validation
[2025-03-28 11:55:44] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 12:13:17] ‚ùå Missing required field: action
[2025-03-28 12:19:19] ‚úÖ update_code applied to test_ben_module.py with type custom_insert
[2025-03-28 12:19:22] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 12:33:29] {'status': 'success', 'steps': [{'status': 'success', 'message': "‚úÖ Created file 'temp_test1.py'"}, {'status': 'error', 'message': '‚ùå Syntax check failed: File not found'}]}
[2025-03-28 12:33:32] üì§ Git push: ‚úÖ Auto-commit: macro 
[2025-03-28 12:42:37] ‚ùå Macro failed. Rolled back all changes.
[2025-03-28 13:06:41] ‚ùå Missing 'file_path' or 'update_type'
[2025-03-28 13:09:24] ‚ùå Unknown action: list_history
[2025-03-28 13:09:41] ‚ùå Unknown action: view_sql_history
[2025-03-28 13:17:17] ‚ùå Exception: name 'handle_list_history' is not defined
[2025-03-28 13:17:29] ‚ùå Exception: name 'get_history' is not defined
[2025-03-28 13:22:15] {'status': 'success', 'history': [{'action': 'git_push', 'message': '‚úÖ Auto-commit: append_file gpt_agent_cache.py', 'timestamp': '2025-03-27 11:46:30'}, {'action': 'append_file', 'filename': 'gpt_agent_cache.py', 'content': "\nimport sqlite3\n\n# –°—Ç–≤–æ—Ä—é—î–º–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö SQLite\ndef create_connection():\n    conn = sqlite3.connect('history.db')\n    return conn\n\n# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ —ñ—Å—Ç–æ—Ä—ñ—ó\ndef create_history_table():\n    conn = create_connection()\n    cursor = conn.cursor()\n    cursor.execute('''\n    CREATE TABLE IF NOT EXISTS history (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        action TEXT NOT NULL,\n        filename TEXT,\n        content TEXT,\n        result TEXT,\n        timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n    )\n    ''')\n    conn.commit()\n    conn.close()\n\n# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏ –≤ —ñ—Å—Ç–æ—Ä—ñ—é\ndef save_to_history(action, filename, content, result):\n    conn = create_connection()\n    cursor = conn.cursor()\n    cursor.execute('''\n    INSERT INTO history (action, filename, content, result)\n    VALUES (?, ?, ?, ?)\n    ''', (action, filename, content, result))\n    conn.commit()\n    conn.close()\n\n# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –∑–∞–ø–∏—Å—ñ–≤ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó\ndef get_history():\n    conn = create_connection()\n    cursor = conn.cursor()\n    cursor.execute('SELECT * FROM history ORDER BY timestamp DESC LIMIT 10')\n    rows = cursor.fetchall()\n    conn.close()\n    return rows\n", 'timestamp': '2025-03-27 12:39:35'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: append_file gpt_agent_cache.py', 'timestamp': '2025-03-27 12:39:44'}, {'action': 'create_file', 'filename': 'test_ben_module.py', 'content': '# –¶–µ–π —Ñ–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è —Ç–µ—Å—Ç—É —Ñ—É–Ω–∫—Ü—ñ—ó update_code\n', 'timestamp': '2025-03-28 10:54:40'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: create_file test_ben_module.py', 'timestamp': '2025-03-28 10:54:43'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code ', 'timestamp': '2025-03-28 11:11:21'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code ', 'timestamp': '2025-03-28 11:12:15'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code ', 'timestamp': '2025-03-28 11:35:55'}, {'action': 'create_file', 'filename': 'test1.py', 'content': '# –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó', 'timestamp': '2025-03-28 11:46:58'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: create_file test1.py', 'timestamp': '2025-03-28 11:47:02'}, {'action': 'create_file', 'filename': 'test2.py', 'content': '# –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –¥–ª—è exceptions', 'timestamp': '2025-03-28 11:47:41'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: create_file test2.py', 'timestamp': '2025-03-28 11:47:44'}, {'action': 'create_file', 'filename': 'test3.py', 'content': '# –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –¥–ª—è logging', 'timestamp': '2025-03-28 11:47:51'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: create_file test3.py', 'timestamp': '2025-03-28 11:47:54'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code_bulk ', 'timestamp': '2025-03-28 11:48:17'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code ', 'timestamp': '2025-03-28 11:55:44'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: update_code ', 'timestamp': '2025-03-28 12:19:22'}, {'action': 'create_file', 'filename': 'temp_test1.py', 'content': '# ok', 'timestamp': '2025-03-28 12:33:29'}, {'action': 'git_push', 'message': '‚úÖ Auto-commit: macro ', 'timestamp': '2025-03-28 12:33:32'}, {'action': 'create_file', 'filename': 'temp_test1.py', 'content': '# –°—Ç–≤–æ—Ä–µ–Ω–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –º–∞—î –∑–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ', 'timestamp': '2025-03-28 12:42:37'}]}
[2025-03-28 13:22:19] üì§ Git push: ‚úÖ Auto-commit: list_history 
[2025-03-28 13:22:24] ‚ùå Failed to fetch from SQLite: no such table: command_history
[2025-03-28 13:48:02] {'status': 'success', 'history': []}
[2025-03-28 13:48:05] üì§ Git push: ‚úÖ Auto-commit: view_sql_history 
[2025-03-28 14:04:41] {'status': 'success', 'history': []}
[2025-03-28 14:04:44] üì§ Git push: ‚úÖ Auto-commit: view_sql_history 
[2025-03-28 16:27:01] üìå Appended to file 'test_append.py'
[2025-03-28 16:27:04] üì§ Git push: ‚úÖ Auto-commit: append_file test_append.py
[2025-03-28 16:27:26] ‚úÖ Created file 'test_append.py'
[2025-03-28 16:27:30] üì§ Git push: ‚úÖ Auto-commit: create_file test_append.py
[2025-03-28 16:27:56] üìå Appended to file 'test_append.py'
[2025-03-28 16:27:59] üì§ Git push: ‚úÖ Auto-commit: append_file test_append.py
[2025-03-28 16:31:18] ‚ö†Ô∏è Function 'test_func' already exists in test_append.py
[2025-03-28 16:42:27] ‚úÖ Created file 'ben_gui_desktop/ben_gui.py'
[2025-03-28 16:42:30] üì§ Git push: ‚úÖ Auto-commit: create_file ben_gui_desktop/ben_gui.py
[2025-03-28 16:45:50] ‚úÖ update_code applied to ben_gui_desktop/ben_gui.py with type custom_insert
[2025-03-28 16:45:53] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 16:45:58] ‚ùå Exception: _path_exists: path should be string, bytes, os.PathLike or integer, not NoneType
[2025-03-28 16:46:28] üîÅ Updated file 'ben_gui_desktop/ben_gui.py'
[2025-03-28 16:46:31] üì§ Git push: ‚úÖ Auto-commit: update_file ben_gui_desktop/ben_gui.py
[2025-03-28 16:59:15] ‚úÖ Created file 'ben_test_check.txt'
[2025-03-28 16:59:18] üì§ Git push: ‚úÖ Auto-commit: create_file ben_test_check.txt
[2025-03-28 17:00:14] ‚ùå Exception: [Errno 2] No such file or directory: 'C:\\\\Users\\\\DC\\\\my-bot-project\\ben_gui_desktop/widgets/action_selector.py'
[2025-03-28 17:00:57] üìÅ Folder 'ben_gui_desktop/widgets' created
[2025-03-28 17:01:00] üì§ Git push: ‚úÖ Auto-commit: create_folder 
[2025-03-28 17:01:14] ‚úÖ Created file 'ben_gui_desktop/widgets/action_selector.py'
[2025-03-28 17:01:17] üì§ Git push: ‚úÖ Auto-commit: create_file ben_gui_desktop/widgets/action_selector.py
[2025-03-28 17:11:18] ‚úÖ Created file 'ben_gui_desktop/main_gui.py'
[2025-03-28 17:11:21] üì§ Git push: ‚úÖ Auto-commit: create_file ben_gui_desktop/main_gui.py
[2025-03-28 17:12:19] ‚úÖ Created file 'ben_gui_desktop/widgets/parameter_form.py'
[2025-03-28 17:12:22] üì§ Git push: ‚úÖ Auto-commit: create_file ben_gui_desktop/widgets/parameter_form.py
[2025-03-28 17:13:02] ‚úÖ update_code applied to ben_gui_desktop/main_gui.py with type custom_insert
[2025-03-28 17:13:06] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 17:13:36] ‚úÖ update_code applied to ben_gui_desktop/main_gui.py with type custom_insert
[2025-03-28 17:13:39] üì§ Git push: ‚úÖ Auto-commit: update_code 
[2025-03-28 17:14:22] ‚úÖ update_code applied to ben_gui_desktop/main_gui.py with type custom_insert
