# 📘 GPT + Ben: Повний Мануал для GPT
> Оновлено: 2025-03-30 23:23:56

---

## 🎯 Мета Проєкту

Ben — це локальний агент, керований GPT, який автоматизує зміну коду, виконує дії над файлами, веде історію, дозволяє rollback змін, аналізує проект і навчається з історії команд.  
Ціль: створити систему подібну до Sora, але для генерації та автономного виконання Python-коду.

---

## 🧠 Обов’язки GPT

- 🔁 Генерація команд у форматі Ben (`append_file`, `update_code`, `insert_between_markers`, тощо)
- 🧾 Пояснення змін (функція `explain_last_action`)
- 💬 Комунікація з користувачем через GUI
- 📤 Надсилання команд до `cache.txt`
- 🧠 Аналіз усіх `.py` файлів (кнопка "Аналіз усього столу")
- ⏪ Виконання rollback змін з підтвердженням

---

## 🛠️ Можливості Ben

### ✅ Основні дії
| Дія | Опис |
|-----|------|
| `append_file` | додати код у файл |
| `update_code` | змінити код у файлі |
| `update_code_bulk` | масова зміна коду |
| `replace_in_file` | заміна тексту через regex |
| `insert_between_markers` | вставка між мітками |
| `run_macro` | виконати макрос |
| `undo_change` | відкат змін по ID |
| `test_python` | перевірка синтаксису |
| `check_status` | чи працює агент |
| `read_file`, `read_folder` | прочитати файл/папку |
| `delete_file`, `copy_file`, `rename_file` | робота з файлами |
| `list_history`, `view_sql_history` | історія |
| `show_memory` | перегляд памʼяті |
| `run_shell` | shell-команди |
| `explain_last_action` | пояснення останньої дії |

---

## 🧠 Модифікації та розширення

- 🔐 Захист `.env` файлів від редагування
- 🧠 Rollback із підтвердженням (yes/no)
- 🔎 Аналіз усіх `.py` файлів у проекті (глобально)
- 🧠 Smart diff між діями (в процесі)
- 💾 Резервне копіювання `.bak` перед змінами
- 🗂️ Історія команд: `.ben_memory.json` + `history.sqlite`
- 🧩 Автозапуск макросів (`run_macro`)
- 🧠 GPT автоматично бачить всі ID дій (`cmd_001` тощо)

---

## 📂 Структура Проєкту

| Компонент | Призначення |
|-----------|-------------|
| `ben_gui_v2.py` | головний GUI |
| `gpt_agent_cache.py` | обробник усіх команд |
| `macros.py` | логіка макросів |
| `.ben_memory.json` | історія дій |
| `cache.txt` | активна команда |
| `debug.log` | лог GPT-аналізу |
| `gpt_response.json` | відповідь GPT |

---

## 🧠 Алгоритм GPT у GUI

1. Користувач вводить запит
2. GPT генерує JSON-команду
3. Команду записують у `cache.txt`
4. Ben зчитує і виконує її
5. GPT відображає результат
6. Якщо відкат — GPT запитує підтвердження

---

## 🔜 Що ще заплановано

- [ ] Порівняння двох дій (`compare_changes`)
- [ ] Пояснення помилок автоматично
- [ ] GPT-підказки при синтаксичних помилках
- [ ] Вставка drag-n-drop блоків у GUI
- [ ] Smart автозаповнення при редагуванні коду
- [ ] Агент з памʼяттю на основі embedding/класифікатора

---

## 📎 Нотатки для GPT

- Завжди повертай один валідний JSON
- Ніколи не додавай пояснень поза JSON
- Дії `run_macro`, `undo_change`, `insert_between_markers` мають завжди мати параметри
- Якщо потрібно rollback — додавай `target_id`
- Якщо дія має ID — GPT повинен памʼятати, що з нею повʼязано
- GPT бачить повну історію через `.ben_memory.json`

---

> Власник: Kermach 🇺🇦 | Версія: GPT + Ben System 2.0
